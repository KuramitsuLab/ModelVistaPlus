# class003 - 図書館システムのクラス図

## 機能要求
1. **図書管理機能**: 図書登録番号と貸出し可能フラグを管理する
2. **図書タイトル管理機能**: 図書タイトル番号、書名、出版社名、発行年を管理する
3. **著者管理機能**: 著者識別IDを管理する
4. **図書分類管理機能**: 分類名を管理する
5. **登録利用者管理機能**: 利用者登録番号、連絡先、本人確認手段を管理する
6. **人物管理機能**: 氏名、生年月日を管理する（著者と登録利用者の共通親クラス）
7. **図書館員管理機能**: 図書館員として識別する
8. **図書貸出管理機能**: 貸出し日、返却期限日を記録する
9. **貸出予約管理機能**: 予約日時を記録する
10. **貸出実施・実行機能**: 貸出しを実施し実行するメソッドを持つ
11. **借り出し権利確認機能**: 登録利用者が借り出し権利を持つか確認する

## 非機能要求
1. **データの階層構造**: 図書館を頂点として、図書、著者、利用者などが関連する複雑な構造
2. **多対多関係の管理**: 図書と著者、図書と分類など複数の多対多関係を持つ
3. **継承による共通化**: 人物クラスを親として著者と登録利用者が継承
4. **トレーサビリティ**: 貸出履歴と予約履歴を追跡可能
5. **柔軟性**: 1つの図書タイトルに複数の図書（コピー）が存在可能

## 依存関係
1. **図書は図書タイトルに依存**: 1つの図書は必ず1つの図書タイトルに関連（多重度1）
2. **図書タイトルは著者に依存**: 著者なしの図書タイトルは存在しない（多重度1以上）
3. **図書タイトルは図書分類に依存**: 分類なしの図書タイトルは存在しない（多重度1..*）
4. **図書は図書館に依存**: 図書は必ず図書館に所属（推測）
5. **登録利用者と著者は人物に依存**: 人物クラスを継承している
6. **図書貸出は図書と登録利用者に依存**: 貸出は図書と利用者の両方が必要
7. **貸出予約は図書タイトルと登録利用者に依存**: 予約は具体的な図書ではなく図書タイトルに対して行われる
8. **貸出実施は貸出予約に依存**: 予約後に実施される（多重度0..1）

## 前提条件・制約
1. **多重度 0..*（図書館-図書館員）**: 図書館には0人以上の図書館員が存在
2. **多重度 0..*（図書館-図書タイトル）**: 図書館には0冊以上の図書タイトルが存在
3. **多重度 0..*（図書館-著者）**: 図書館には0人以上の著者が関連
4. **多重度 0..*（図書館-図書分類）**: 図書館には0個以上の分類が存在
5. **多重度 1（図書-図書タイトル）**: 1つの図書は必ず1つの図書タイトルに属する
6. **多重度 0..*（図書タイトル-著者）**: 図書タイトルは0人以上の著者を持つ
7. **多重度 1..*（図書タイトル-図書分類）**: 図書タイトルは1つ以上の分類を持つ
8. **多重度 0..1（図書-図書貸出）**: 1つの図書は0または1つの貸出レコードを持つ
9. **多重度 0..*（登録利用者-図書貸出）**: 1人の利用者は0冊以上借りられる
10. **多重度 0..1（貸出予約-図書貸出）**: 1つの予約は0または1つの貸出に対応
11. **多重度 0..*（貸出予約-図書タイトル）**: 図書タイトルは0個以上の予約を持つ

## リスク・例外条件
1. **貸出可能フラグの管理**: フラグの更新タイミングと整合性の保証が必要
2. **返却期限の超過**: 延滞時の処理（罰金、貸出停止など）が不明
3. **予約の競合**: 複数の利用者が同じ図書タイトルを予約した場合の優先順位が不明
4. **図書の紛失・破損**: 図書が返却されない場合や破損した場合の処理が不明
5. **貸出上限**: 1人の利用者が同時に借りられる図書の上限が不明
6. **予約のキャンセル**: 予約をキャンセルする機能が明示されていない
7. **図書館員の権限**: 図書館員が実行できる操作の範囲が不明
8. **著者情報の不足**: 著者に属性が識別IDしかなく、氏名などの情報が不足

## その他の開発上の重要な判断材料
1. **図書とコピーの概念**: 同じタイトルの図書が複数存在する設計
2. **予約システム**: 予約から貸出への遷移フローが存在
3. **継承の活用**: 人物クラスを親として共通属性を管理
4. **複雑な関連**: 図書館を中心に多数のクラスが関連
5. **状態管理**: 図書の貸出可能/不可の状態管理が必要
6. **時間管理**: 貸出日、返却期限日、予約日時などの時間情報が重要
7. **権利チェック**: 借り出し権利の確認ロジックが必要
8. **通知機能**: 返却期限の通知、予約した図書が利用可能になった際の通知などが必要（図には明示されていない）
