# 開発判断に関連する要素

## 機能要求
- ユーザー管理機能（登録、削除フラグによる論理削除）
- 蔵書管理機能（書籍情報の登録、論理削除）
- 貸出管理機能（貸出記録、返却記録）
- ユーザーごとの貸出履歴参照
- 書籍ごとの貸出履歴参照

## 非機能要求
- データ整合性：外部キー制約によるユーザーと書籍の参照整合性
- 拡張性：論理削除により履歴データを保持
- トレーサビリティ：貸出日時（lent_at）と返却日時（returned_at）による履歴追跡

## 依存関係
- 貸出記録（lendings）はユーザー（users）の存在に依存
- 貸出記録（lendings）は蔵書（books）の存在に依存
- 返却処理は貸出記録の存在に依存

## 前提条件・制約
- ユーザーと書籍の削除は論理削除（delete_flag）を使用
- 貸出記録には必ず貸出日時（lent_at）が記録される
- 返却日時（returned_at）は返却時に更新される（貸出中はNULL想定）
- ISBNによる書籍の一意識別が可能

## リスク・例外条件
- 削除フラグが立ったユーザーや書籍の貸出記録の扱い
- 返却されていない貸出記録の検出（returned_atがNULL）
- 同一書籍の重複貸出の制御（在庫管理が図に含まれていない）
- ユーザーや書籍が物理削除された場合の参照整合性エラー
