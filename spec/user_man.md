# ユーザマニュアル：ベンチマーク問題レビューツール

## 目次
1. [はじめに](#1-はじめに)
2. [セットアップ](#2-セットアップ)
3. [基本操作](#3-基本操作)
4. [Git運用手順](#4-git運用手順)
5. [トラブルシューティング](#5-トラブルシューティング)
6. [FAQ](#6-faq)

---

## 1. はじめに

### 1.1 本ツールについて
ベンチマーク問題レビューツールは、UMLモデル図などを参照する4選択問題の品質レビューを効率化するためのブラウザベースのツールです。画像を見ながら問題を確認し、採用・不採用を判定できます。

### 1.2 動作環境
- **対応ブラウザ**: Chrome、Firefox、Safari、Edge（最新版推奨）
- **推奨画面サイズ**: 1280px × 800px以上
- **必要なもの**:
  - Gitリポジトリのクローン（`ModelVistaPlus/`）
  - ブラウザ
  - テキストエディタ（Git操作用）

### 1.3 レビュー対象データ
- フォルダ: `model/activity001/`, `model/class001/`, etc.
- JSONファイル: `qa_new_ja.json`, `qa_new_ja2.json`
- 画像ファイル: `dgpowerpoint_ja-fs8.png`

---

## 2. セットアップ

### 2.1 リポジトリのクローン
```bash
git clone <リポジトリURL>
cd ModelVistaPlus
```

### 2.2 サーバーの起動
**重要**: このツールはPythonサーバーが必要です。

1. **方法1: start_server.shを使用**
   ```bash
   ./start_server.sh
   ```

2. **方法2: 直接server.pyを実行**
   ```bash
   python3 server.py
   ```

3. サーバーが起動すると、以下のメッセージが表示されます：
   ```
   サーバーが起動しました: http://localhost:8000
   ブラウザで以下のURLを開いてください:
     → http://localhost:8000/src/index.html
   ```

### 2.3 ツールの起動
1. ブラウザ（Chrome、Edge、Opera推奨）を開く
2. 以下のURLにアクセス：
   ```
   http://localhost:8000/src/index.html
   ```
3. ツールが起動し、初期画面が表示されます

---

## 3. 基本操作

### 3.1 レビュワー名の入力
1. 画面右上の「レビュワー名」欄に名前を入力
   - 例: `山田太郎`
2. 入力した名前は自動的に保存され、次回起動時に復元されます

### 3.2 フォルダの選択
1. 「フォルダ」ドロップダウンから対象フォルダを選択
   - 例: `activity001`
2. フォルダ一覧は`model/`ディレクトリから自動的に読み込まれます

### 3.3 JSONファイルの選択
1. フォルダを選択すると、自動的に「JSON」ドロップダウンが表示されます
2. ドロップダウンから対象のJSONファイルを選択
   - `qa_new_ja.json`
   - または `qa_new_ja2.json`
3. **レビュー済み表示**:
   - すでにレビュー済みの場合、「✅ レビュー済み」と表示されます
   - レビュー済みでもファイルを選択すれば、内容を確認できます

### 3.4 画像と問題の自動読み込み
- JSONファイルを選択すると、以下が自動的に読み込まれます：
  - 画像（`dgpowerpoint_ja-fs8.png`）が画面左側に表示
  - 問題一覧が画面右側に表示
- 画像が表示されない場合は、ブラウザのコンソール（F12）でエラーを確認してください

### 3.5 問題のレビュー

#### 画面の見方
```
┌─────────────────────────────────────────────────────────────┐
│ ベンチマーク問題レビューツール    [レビュワー: 山田太郎]      │
├──────────────────────┬──────────────────────────────────────┤
│                      │  第1問 / 全10問       残り 9問       │
│                      ├──────────────────────────────────────┤
│                      │ [タグ: 依存関係]                      │
│                      │                                      │
│   画像表示エリア      │ 【問題】                             │
│                      │ 「PC利用登録チケット作成フォームの表示│
│                      │ 」が実行される前に必ず完了していなけれ│
│                      │ ばならない処理はどれか?               │
│                      │                                      │
│                      │ ┌─────────────────────────────────┐ │
│                      │ │ ○ ★正解: 問い合わせ種別に「PC  │ │
│                      │ │          利用登録」を指定        │ │
│                      │ │ ○ 依頼先情報を入力してチケットを │ │
│                      │ │    確定                          │ │
│                      │ │ ○ 入力内容の確認表示             │ │
│                      │ │ ○ チケットを保存し受付メールを   │ │
│                      │ │    送信                          │ │
│                      │ └─────────────────────────────────┘ │
│                      │                                      │
│                      │ ○ 採用      ○ 不採用                │
│                      │ ┌────────────────────────────────┐  │
│                      │ │ 備考:                           │  │
│                      │ │                                 │  │
│                      │ └────────────────────────────────┘  │
├──────────────────────┴──────────────────────────────────────┤
│ [前へ]                                          [次へ]      │
└─────────────────────────────────────────────────────────────┘
```

#### レビュー手順
1. **画像を確認**
   - 左側の画像を見て、問題の背景となるUMLモデル図などを確認

2. **問題文を読む**
   - タグ（例：依存関係、機能要求）を確認
   - 問題文を読む

3. **選択肢を確認**
   - 4つの選択肢が表示されます
   - **正解（choice[0]）は緑色の背景と★マークで強調表示**されます

4. **採用・不採用を判定**
   - 問題の品質を評価し、以下のいずれかを選択:
     - **採用**: 良問であり、ベンチマークに含めるべき
     - **不採用**: 問題があり、改善または除外すべき

5. **備考を入力（オプション）**
   - 不採用の理由や改善提案を記入
   - 例: 「選択肢が曖昧」「問題文が長すぎる」

6. **次の問題へ**
   - 「次へ」ボタンをクリック
   - レビュー結果は自動的に保存されます

### 3.6 ナビゲーション
- **次へボタン**: 次の問題に進む（採用/不採用を選択していない場合は無効）
- **前へボタン**: 前の問題に戻る（判定を変更可能）
- **キーボードショートカット**（オプション）:
  - `→`: 次へ
  - `←`: 前へ

### 3.7 レビュー完了とエクスポート
1. 全問題のレビューが完了したら、「エクスポート」ボタンをクリック
2. 確認ダイアログが表示されます：
   - レビュワー名
   - フォルダ名・ファイル名
   - レビュー済み問題数・採用数・不採用数
3. 「OK」をクリックすると、以下のファイルが**自動的に`model/{フォルダ名}/`に保存**されます：
   - `{ベースファイル名}_approved.json`（採用問題）
     - 例: `qa_new_ja_approved.json`, `qa_new_ja2_approved.json`
   - `{ベースファイル名}_rejected.json`（不採用問題）
     - 例: `qa_new_ja_rejected.json`, `qa_new_ja2_rejected.json`
   - `review_status.json`（レビュー状態、フォルダ全体で1つ）

**注意**: ダウンロードではなく、サーバー経由で直接フォルダに保存されます。

---

## 4. Git運用手順

### 4.1 レビュー開始前
```bash
# 最新状態を取得
git pull

# ブランチを作成（オプション）
git checkout -b review/activity001-yamada
```

### 4.2 レビュー実施
1. Pythonサーバーを起動（`python3 server.py` または `./start_server.sh`）
2. ブラウザでツールを開く（`http://localhost:8000/src/index.html`）
3. レビュー作業を実施
4. 「エクスポート」ボタンをクリック
5. ファイルが自動的に`model/{フォルダ名}/`に保存される

### 4.3 レビュー結果のコミット
```bash
# 保存されたファイルを確認
ls model/activity001/

# 出力例:
# - qa_new_ja_approved.json
# - qa_new_ja_rejected.json
# - qa_new_ja2_approved.json
# - qa_new_ja2_rejected.json
# - review_status.json

# ファイルをステージング
git add model/activity001/*_approved.json
git add model/activity001/*_rejected.json
git add model/activity001/review_status.json

# コミット
git commit -m "Review: activity001 by 山田太郎

- qa_new_ja.json: 採用7問, 不採用3問
- qa_new_ja2.json: 採用5問, 不採用3問
- レビュー日時: 2025-10-21"

# リモートにプッシュ
git push origin review/activity001-yamada
```

### 4.4 プルリクエスト（オプション）
1. GitHubなどでプルリクエストを作成
2. レビュー内容を共有
3. マージ

### 4.5 複数JSONファイルのレビュー
- `qa_new_ja.json`と`qa_new_ja2.json`は独立して管理されます
- 両方をレビューする場合：
  1. `qa_new_ja.json`を選択してレビュー → エクスポート
  2. `qa_new_ja2.json`を選択してレビュー → エクスポート
  3. 両方のファイルを一度にコミット
- 異なる人が同時に別々のJSONファイルをレビューすることも可能

---

## 5. トラブルシューティング

### 5.1 サーバーが起動しない
**原因**: Python 3がインストールされていない、またはポート8000が使用中

**対処法**:
1. Python 3のインストールを確認：
   ```bash
   python3 --version
   ```
2. ポート8000が使用中の場合、他のプロセスを終了
3. `server.py`のポート番号を変更（8001など）

### 5.2 画像が表示されない
**原因**: ファイルパスが正しくない、または画像ファイルが存在しない

**対処法**:
1. `model/activity001/dgpowerpoint_ja-fs8.png`が存在するか確認
2. ブラウザのコンソールでエラーを確認（F12キー → Console → Networkタブ）
3. サーバーのログでファイル読み込みエラーを確認

### 5.3 JSONファイルが読み込めない
**原因**: JSON形式が不正、またはファイルが存在しない

**対処法**:
1. JSONファイルをテキストエディタで開き、構文エラーがないか確認
2. JSONバリデータ（例: jsonlint.com）で検証
3. ブラウザのコンソールでエラーメッセージを確認

### 5.4 LocalStorageがいっぱいになった
**原因**: ブラウザのLocalStorage容量制限（約5-10MB）を超えた

**対処法**:
1. ブラウザの開発者ツール（F12）を開く
2. Application > Local Storage > `http://localhost:8000`を選択
3. 不要なレビュー状態を削除
4. または、ブラウザのキャッシュをクリア

### 5.5 「次へ」ボタンが押せない
**原因**: 採用/不採用を選択していない

**対処法**:
1. 「採用」または「不採用」を選択してから「次へ」をクリック

### 5.6 ブラウザを閉じたら進捗が消えた
**原因**: LocalStorageが無効化されている、またはプライベートブラウジングモード

**対処法**:
1. 通常のブラウジングモードで開く
2. ブラウザの設定でLocalStorageを有効化
3. Cookieの設定を確認

### 5.7 エクスポートが失敗する
**原因**: サーバーが停止している、またはファイルの書き込み権限がない

**対処法**:
1. サーバーが起動しているか確認
2. ブラウザのコンソールでエラーメッセージを確認
3. `model/{フォルダ名}/`ディレクトリの書き込み権限を確認

---

## 6. FAQ

### Q1: 複数人で同じJSONファイルをレビューできますか？
**A**: 推奨しません。`review_status.json`でレビュー担当者を記録しているため、事前に担当者を決めてください。ただし、**同じフォルダ内の異なるJSONファイル**（例：Aさんが`qa_new_ja.json`、Bさんが`qa_new_ja2.json`）であれば、同時にレビュー可能です。

### Q2: 途中でブラウザを閉じても大丈夫ですか？
**A**: はい。レビュー状態はLocalStorageに自動保存されます。次回起動時に同じフォルダとJSONファイルを選択すれば、続きから再開できます。

### Q3: 画像をズーム/パンできますか？
**A**: 現在のバージョンでは未実装です。ブラウザのズーム機能（Ctrl + +/- または Cmd + +/-）を使用してください。

### Q4: エクスポート後にレビュー結果を修正できますか？
**A**: はい。ツールを再度開き、同じフォルダとJSONファイルを選択すれば、LocalStorageから状態が復元されます。修正後、再度エクスポートしてください（上書き保存）。

### Q5: `qa_old_ja.json`には対応していますか？
**A**: 現在のバージョンでは未対応です。将来のバージョンで対応予定です。

### Q6: 出力ファイルのファイル名を変更できますか？
**A**: 自動生成されるファイル名（`qa_new_ja_approved.json`, `qa_new_ja2_approved.json`など）は固定です。手動でリネームすることは可能ですが、レビュー済み表示が機能しなくなります。

### Q7: レビュー統計を見ることはできますか？
**A**: `review_status.json`に採用数・不採用数が記録されています。このファイルをテキストエディタで開いて確認してください。将来のバージョンでダッシュボード機能を追加予定です。

### Q8: スマートフォンで使用できますか？
**A**: 画面サイズの制約により、推奨しません。PCまたはタブレット（1280px以上）を使用してください。

### Q9: サーバーを停止するにはどうすればいいですか？
**A**: ターミナルで`Ctrl + C`を押してサーバーを停止できます。

### Q10: 複数のフォルダを同時にレビューできますか？
**A**: 1つのブラウザタブで1つのフォルダをレビューできます。複数のフォルダを同時にレビューしたい場合は、複数のブラウザタブを開いてください。

---

## 7. ベストプラクティス

### 7.1 効率的なレビューのコツ
1. **画像を先に確認**: 問題文を読む前にUML図を把握
2. **タグを活用**: タグ（依存関係、機能要求など）で問題の種類を把握
3. **備考欄を活用**: 不採用理由を明確に記載（後で見返す際に便利）
4. **定期的にエクスポート**: 長時間作業する場合、途中で一度エクスポートして保存

### 7.2 品質チェックポイント
- **問題文の明確性**: 曖昧な表現がないか
- **選択肢の質**: 誤答が明確に誤答とわかるか
- **正解の妥当性**: 画像と整合しているか
- **難易度**: 難しすぎる/簡単すぎないか

### 7.3 Git運用のコツ
- **頻繁にコミット**: フォルダごと、またはJSONファイルごとにコミット
- **わかりやすいコミットメッセージ**: レビュー結果の概要を記載（採用数・不採用数など）
- **プルリクエストでレビュー**: 他のレビュワーと意見交換
- **複数JSONファイルのレビュー**: 両方のJSONファイルをレビューしてから一度にコミット

### 7.4 レビュー済み表示の活用
- フォルダを選択した際、JSONドロップダウンに「✅ レビュー済み」と表示されます
- レビュー済みでも内容を確認したい場合は、再度選択可能
- 修正が必要な場合は、再度エクスポートして上書き保存

---

## 8. サポート

### 8.1 問い合わせ
- **バグ報告**: GitHubのIssueに報告
- **機能要望**: GitHubのIssueまたはPull Requestで提案

### 8.2 ドキュメント
- **要件定義書**: `spec/req.md`
- **アーキテクチャ設計書**: `spec/arch.md`
- **ユーザマニュアル**: `spec/user_man.md`（本書）

---

## 9. 更新履歴

| バージョン | 日付       | 変更内容                     |
|-----------|-----------|------------------------------|
| 1.0.0     | 2025-10-21| 初版リリース                 |

---

以上で本マニュアルは終了です。問題のレビュー作業を効率的に進めてください。
